<ion-header [translucent]="true" class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button style="color: var(--med-teal);"></ion-menu-button>
    </ion-buttons>

    <ion-title>
      Bed {{ patient.selectedBedId }}
      <span *ngIf="patient.current?.naam" style="font-size: 0.8em; opacity: 0.9;">
          - {{ patient.current.naam }}
      </span>
    </ion-title>

    <ion-buttons slot="end">
      <div class="bed-selector-box">
        <ion-icon name="bed-outline"></ion-icon>
        <ion-select
          [value]="patient.selectedBedId"
          (ionChange)="wisselBed($event)"
          interface="popover"
          [interfaceOptions]="{'cssClass': 'mijn-bed-popover'}"
          placeholder="Kies"
          toggleIcon="chevron-down-outline">
          <ion-select-option *ngFor="let bed of patient.beds" [value]="bed.bedId">
            Bed {{ bed.bedId }}
          </ion-select-option>
        </ion-select>
      </div>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">

  <ion-card class="data-card">
    <ion-card-header>
      <ion-card-title>PatiÃ«nt Gegevens</ion-card-title>
    </ion-card-header>

    <ion-card-content>

      <ion-grid style="padding: 0; margin-bottom: 5px;">
        <ion-row>
          <ion-col size="8">
            <ion-input
              class="custom-green-input"
              label="Naam / Initialen"
              label-placement="floating"
              fill="outline"
              type="text"
              [(ngModel)]="patient.current.naam"
              (ionInput)="dataGewijzigd()">
            </ion-input>
          </ion-col>

          <ion-col size="4">
            <ion-input
              class="custom-green-input"
              label="Leeftijd"
              label-placement="floating"
              fill="outline"
              type="number"
              inputmode="decimal"
              placeholder=""
              [(ngModel)]="patient.current.leeftijd"
              (ionInput)="dataGewijzigd()">
            </ion-input>
          </ion-col>
        </ion-row>
      </ion-grid>

      <ion-segment [(ngModel)]="patient.current.geslacht" (ionChange)="dataGewijzigd()" class="gender-segment" mode="ios" style="margin-bottom: 20px;">
        <ion-segment-button value="M">
          <ion-icon name="male-outline"></ion-icon> <ion-label>Man</ion-label>
        </ion-segment-button>
        <ion-segment-button value="V">
          <ion-icon name="female-outline"></ion-icon> <ion-label>Vrouw</ion-label>
        </ion-segment-button>
      </ion-segment>

      <ion-grid style="padding: 0;">
        <ion-row>
          <ion-col size="6">
            <ion-input
              class="custom-green-input"
              label="Lengte (cm)"
              label-placement="floating"
              fill="outline"
              type="number"
              inputmode="decimal"
              placeholder=""
              [(ngModel)]="patient.current.lengte"
              (ionInput)="dataGewijzigd()">
            </ion-input>
          </ion-col>
          <ion-col size="6">
            <ion-input
              class="custom-green-input"
              label="Gewicht (kg)"
              label-placement="floating"
              fill="outline"
              type="number"
              inputmode="decimal"
              placeholder=""
              [(ngModel)]="patient.current.gewicht"
              (ionInput)="dataGewijzigd()">
            </ion-input>
          </ion-col>
        </ion-row>
      </ion-grid>

      <div *ngIf="patient.current.ibw || patient.current.bsa" style="margin-top: 25px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
        <ion-item lines="none" class="result-item" style="--background: transparent; --min-height: 30px;">
          <ion-label style="color: #aaa;">Ideaal Gewicht (IBW)</ion-label>
          <ion-note slot="end" style="font-size: 1.2em; font-weight: bold; color: #28a745;">
            {{ patient.current.ibw | number:'1.0-0' }} kg
          </ion-note>
        </ion-item>

        <ion-item lines="none" class="result-item" style="--background: transparent; --min-height: 30px;">
          <ion-label style="color: #aaa;">Lichaamsoppervlak (BSA)</ion-label>
          <ion-note slot="end" style="font-size: 1.2em; font-weight: bold; color: #28a745;">
            {{ patient.current.bsa | number:'1.2-2' }} mÂ²
          </ion-note>
        </ion-item>
      </div>

      <div style="margin-top: 30px; text-align: center;">
        <ion-button color="danger" fill="outline" (click)="wisPatient()">
          <ion-icon name="trash-outline" slot="start"></ion-icon>
          PatiÃ«nt Ontslag / Wissen
        </ion-button>
      </div>

      <div style="text-align: center; margin-top: 40px; margin-bottom: 10px; padding: 0 20px;">
        <ion-text color="medium">
          <p style="font-size: 0.7em; line-height: 1.4; font-style: italic; opacity: 0.6;">
            Disclaimer: Deze applicatie is bedoeld als ondersteunend hulpmiddel voor professionals.
            De auteur aanvaardt geen aansprakelijkheid voor de uitkomsten.
            Verifieer berekeningen altijd voor klinisch gebruik.
            <br>
Voor meer info mail naar
<a href="mailto:info.webapp@icloud.com" style="color: #69f0ae; text-decoration: none; font-weight: bold;">
  info.webapp@icloud.com
</a>
<br>
          </p>
        </ion-text>
      </div>

    </ion-card-content>
  </ion-card>
</ion-content>

<ion-footer class="ion-no-border minimal-footer">
  <ion-toolbar>
    <div class="ion-text-center">
      <ion-note>

        <ion-icon
          name="information-circle-outline"
          class="info-icon"

          (click)="setOpen(true)">
        </ion-icon>
      </ion-note>
    </div>
  </ion-toolbar>
</ion-footer>

<ion-modal [isOpen]="isModalOpen">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>App Installeren</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="setOpen(false)">
            <ion-icon name="close-outline"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content class="ion-padding">
      <div class="install-guide">
        <h3>ðŸ“± Haal het beste uit de app</h3>
        <p>Installeer de IC calculator als app op je telefoon voor de beste gebruikservaring zonder browser-randen.</p>

        <ion-card>
          <ion-card-content>
            <h4><ion-icon name="logo-android" color="success"></ion-icon> Android</h4>
            <p>Gebruik <b>Google Chrome</b>.</p>
            <ol>
              <li>Klik op de <b>"Install"</b> knop rechtsboven in deze app.</li>
              <li>Of tik op de <b>3 puntjes</b> (menu) en kies <i>"App installeren"</i>.</li>
            </ol>
            <p style="font-size: 0.9em; color: gray;">
              <i>Tip: Gebruik geen Samsung Internet of Edge als je een mooi icoon wilt zonder browser-logo.</i>
            </p>
          </ion-card-content>
        </ion-card>

        <ion-card>
          <ion-card-content>
            <h4><ion-icon name="logo-apple"></ion-icon> iPhone / iPad</h4>
            <p>Gebruik <b>Safari</b>.</p>
            <ol>
              <li>Tik onderin op de <b>Deel-knop</b> <br>(vierkantje met pijl omhoog).</li>
              <li>Scroll naar beneden.</li>
              <li>Kies <b>"Zet op beginscherm"</b>.</li>
            </ol>
          </ion-card-content>
        </ion-card>

        <br>
       <ion-button expand="block" class="teal-btn" (click)="setOpen(false)">
  OK!
</ion-button>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>
